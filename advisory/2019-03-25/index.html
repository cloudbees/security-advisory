<h1>CloudBees Security Advisory 2019-03-25</h1>
<p>This advisory announces vulnerabilities in<strong>
Jenkins, CloudBees Jenkins Distribution, CloudBees Jenkins Platform and CloudBees Core.
</strong></p>
<h3 id='SECURITY-1353'>Sandbox bypass in Script Security Plugin and Pipeline: Groovy Plugin
</h3>
<strong>SECURITY-1353 / CVE pending</strong>
<div class="paragraph">
<p>Sandbox projection in the Script Security and Pipeline: Groovy Plugins could be circumvented through methods supporting type casts and type coercion.
This allowed attackers to invoke constructors for arbitrary types.</p>
</div>
<div class="paragraph">
<p>Script Security and Pipeline: Groovy have been hardened to prevent these methods of bypassing sandbox protection.</p>
</div>
<h3 id='SECURITY-1361'>XSS vulnerability in Lockable Resources Plugin
</h3>
<strong>SECURITY-1361 / CVE pending</strong>
<div class="paragraph">
<p>Lockable Resources Plugin did not properly escape resource names in generated JavaScript code, thus leading to a cross-site scripting (XSS) vulnerability.</p>
</div>
<div class="paragraph">
<p>The plugin now properly escapes resource names in its scripts.</p>
</div>
<h3 id='SECURITY-976'>CSRF vulnerability and missing permission checks in Slack Notification Plugin allowed capturing credentials
</h3>
<strong>SECURITY-976 / CVE pending</strong>
<div class="paragraph">
<p>Notification Plugin Plugin did not perform permission checks on a method implementing form validation.
This allowed users with Overall/Read access to Jenkins to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.</p>
</div>
<div class="paragraph">
<p>Additionally, this form validation method did not require POST requests, resulting in a cross-site request forgery vulnerability.</p>
</div>
<div class="paragraph">
<p>This form validation method now requires POST requests and Overall/Administer (for global configuration) or Item/Configure permissions (for job configuration).</p>
</div>
<h3 id='SECURITY-846'>ECS Publisher Plugin stored and displayed API token in plain text
</h3>
<strong>SECURITY-846 / CVE pending</strong>
<div class="paragraph">
<p>ECS Publisher Plugin stored the API token unencrypted in jobs' <code>config.xml</code> files and its global configuration file on the Jenkins master.
This token could be viewed by users with Extended Read permission, or access to the master file system.</p>
</div>
<div class="paragraph">
<p>Additionally, the API token was not masked from view using a password form field.</p>
</div>
<div class="paragraph">
<p>The plugin now stores the API token encrypted in the configuration files on disk and no longer transfers it to users viewing the configuration form in plain text.</p>
</div>
<h3 id='SECURITY-992'>SSRF vulnerability due to missing permission check in Fortify on Demand Uploader Plugin
</h3>
<strong>SECURITY-992 / CVE pending</strong>
<div class="paragraph">
<p>A missing permission check in multiple form validation methods in Fortify on Demand Uploader Plugin allowed users with Overall/Read permission to initiate a connection test to an attacker-specified server.</p>
</div>
<div class="paragraph">
<p>Additionally, the form validation methods did not require POST requests, resulting in a CSRF vulnerability.</p>
</div>
<div class="paragraph">
<p>The form validation methods now require POST requests and perform a permission check.</p>
</div>
<h3 id='SECURITY-1089'>PRQA Plugin stored password in plain text
</h3>
<strong>SECURITY-1089 / CVE pending</strong>
<div class="paragraph">
<p>PRQA Plugin stored a password unencrypted in its global configuration file on the Jenkins master.
This password could be viewed by users with access to the master file system.</p>
</div>
<div class="paragraph">
<p>The plugin now stores the password encrypted in the configuration files on disk.</p>
</div>
<h3 id='SECURITY-1086'>Codebeamer Test Results Trend Updater Plugin stored password in plain text
</h3>
<strong>SECURITY-1086 / CVE pending</strong>
<div class="paragraph">
<p>Codebeamer Test Results Trend Updater Plugin stored username and password in its configuration unencrypted in jobs' <code>config.xml</code> files on the Jenkins master.
This password could be viewed by users with Extended Read permission, or access to the master file system.</p>
</div>
<div class="paragraph">
<p>The plugin now integrates with <a href="https://plugins.jenkins.io/credentials">Credentials Plugin</a>.</p>
</div>
<h3 id='SECURITY-1328'>Unprivileged users with Overall/Read access were able to enumerate credential IDs in Arxan MAM Publisher Plugin
</h3>
<strong>SECURITY-1328 / CVE pending</strong>
<div class="paragraph">
<p>Arxan MAM Publisher Plugin provides a list of applicable credential IDs to allow administrators configuring the plugin to select the one to use.</p>
</div>
<div class="paragraph">
<p>This functionality did not check permissions, allowing any user with Overall/Read permission to get a list of valid credentials IDs.
Those could be used as part of an attack to capture the credentials using another vulnerability.</p>
</div>
<div class="paragraph">
<p>An enumeration of credentials IDs in this plugin now requires Overall/Administer permission.</p>
</div>
<p></p>
<h4>Severity</h4>
<ul>
<li>SECURITY-846:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>Medium</a></li>
<li>SECURITY-976:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>Medium</a></li>
<li>SECURITY-992:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N'>Medium</a></li>
<li>SECURITY-1086:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>Medium</a></li>
<li>SECURITY-1089:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>Low</a></li>
<li>SECURITY-1328:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>Medium</a></li>
<li>SECURITY-1353:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H'>High</a></li>
<li>SECURITY-1361:<a href='http://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N'>Medium</a></li>
</ul>
<p></p>
<h4>Fix</h4>
<ul>
<li><strong>CloudBees Traditional Platforms</strong>&nbsp;should be upgraded 2.164.1.2-rev2</li>
<li><strong>CloudBees Cloud Platforms</strong>&nbsp;should be upgraded 2.164.1.2-rev2</li>
<li><strong>CloudBees Jenkins Enterprise</strong>&nbsp;should be upgraded the Managed Masters and Operations Center to 2.164.1.2-rev2</li>
<li><strong>CloudBees Jenkins Platform</strong>&nbsp;(rolling train, CJP Operations Center and CJP Client Master (2.x.y.z) should be upgraded to version 2.164.1.2-rev2</li>
<li><strong>CloudBees Jenkins Platform</strong>&nbsp;(fixed train, CJP Operations Center and CJP Client Master (2.138.x.0.z) should be upgraded to version 2.138.40.0.2-rev5</li>
<li><strong>CloudBees Jenkins Platform</strong>&nbsp;(fixed train, CJP Operations Center and CJP Client Master (2.107.x.0.z) should be upgraded to version 2.107.37.0.2-rev7</li>
<li><strong>CloudBees Jenkins Distribution</strong>&nbsp;should be upgraded to version 2.164.1.2-rev2</li>
</ul>
